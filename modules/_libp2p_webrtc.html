<!DOCTYPE html><html class="default" lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>@libp2p/webrtc | libp2p</title><meta name="description" content="Documentation for libp2p"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="../assets/style.css"/><link rel="stylesheet" href="../assets/highlight.css"/><script defer src="../assets/main.js"></script><script async src="../assets/icons.js" id="tsd-icons-script"></script><script async src="../assets/search.js" id="tsd-search-script"></script><script async src="../assets/navigation.js" id="tsd-nav-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><div class="table-cell" id="tsd-search" data-base=".."><div class="field"><label for="tsd-search-field" class="tsd-widget tsd-toolbar-icon search no-caption"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><use href="../assets/icons.svg#icon-search"></use></svg></label><input type="text" id="tsd-search-field" aria-label="Search"/></div><div class="field"><div id="tsd-toolbar-links"></div></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="../index.html" class="title">libp2p</a></div><div class="table-cell" id="tsd-widgets"><a href="#" class="tsd-widget tsd-toolbar-icon menu no-caption" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><use href="../assets/icons.svg#icon-menu"></use></svg></a></div></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><ul class="tsd-breadcrumb"><li><a href="../index.html">libp2p</a></li><li><a href="_libp2p_webrtc.html">@libp2p/webrtc</a></li></ul><h1>Module @libp2p/webrtc</h1></div><section class="tsd-panel tsd-comment"><div class="tsd-comment tsd-typography"><p>A <a href="https://docs.libp2p.io/concepts/transports/overview/">libp2p transport</a> based on <a href="https://webrtc.org/">WebRTC datachannels</a>.</p>
<p><a href="https://www.w3.org/TR/webrtc/">WebRTC</a> is a specification that allows real-time communication between nodes - it&#39;s commonly used in browser video conferencing applications but it also provides a reliable data transport mechanism called <a href="https://www.w3.org/TR/webrtc/#peer-to-peer-data-api">data channels</a> which libp2p uses to facilitate <a href="https://docs.libp2p.io/concepts/multiplex/overview/">protocol streams</a> between peers.</p>
<p>There are two transports exposed by this module, <a href="https://github.com/libp2p/specs/blob/master/webrtc/webrtc.md">webRTC</a> and <a href="https://github.com/libp2p/specs/blob/master/webrtc/webrtc-direct.md">webRTCDirect</a>.</p>
<a id="md:webrtc-vs-webrtc-direct" class="tsd-anchor"></a><h2><a href="#md:webrtc-vs-webrtc-direct">WebRTC vs WebRTC Direct</a></h2><p>The connection establishment phase of WebRTC involves a handshake using <a href="https://en.wikipedia.org/wiki/Session_Description_Protocol">SDP</a> during which two peers will exchange information such as open ports, network addresses and required capabilities.</p>
<p>A third party is usually necessary to carry out this handshake, forwarding messages between the two peers until they can make a direct connection between themselves.</p>
<p>The WebRTC transport uses libp2p <a href="https://docs.libp2p.io/concepts/nat/circuit-relay/">Circuit Relay</a>s to forward SDP messages. Once a direct connection is formed the relay plays no further part in the exchange.</p>
<p>WebRTC Direct uses a technique known as <a href="https://webrtchacks.com/not-a-guide-to-sdp-munging/">SDP munging</a> to skip the handshake step, instead encoding enough information in the connection request that the responder can derive what would have been in the handshake messages and so requires no third parties to establish a connection.</p>
<p>A WebRTC Direct multiaddr also includes a certhash of the target peer - this is used to allow opening a connection to the remote, which would otherwise be denied due to use of a self-signed certificate.</p>
<p>In both cases, once the connection is established a <a href="https://noiseprotocol.org/noise.html">Noise handshake</a> is carried out to ensure that the remote peer has the private key that corresponds to the public key that makes up their PeerId, giving you both encryption and authentication.</p>
</div><div class="tsd-comment tsd-typography"><h4>Example: WebRTC</h4><p>WebRTC requires use of a relay to connect two nodes. The listener first discovers a relay server and makes a reservation, then the dialer can connect via the relayed address.</p>
<pre><code class="language-TypeScript"><span class="hl-4">import</span><span class="hl-1"> { </span><span class="hl-5">noise</span><span class="hl-1"> } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&#39;@chainsafe/libp2p-noise&#39;</span><br/><span class="hl-4">import</span><span class="hl-1"> { </span><span class="hl-5">yamux</span><span class="hl-1"> } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&#39;@chainsafe/libp2p-yamux&#39;</span><br/><span class="hl-4">import</span><span class="hl-1"> { </span><span class="hl-5">echo</span><span class="hl-1"> } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&#39;@libp2p/echo&#39;</span><br/><span class="hl-4">import</span><span class="hl-1"> { </span><span class="hl-5">circuitRelayTransport</span><span class="hl-1">, </span><span class="hl-5">circuitRelayServer</span><span class="hl-1"> } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&#39;@libp2p/circuit-relay-v2&#39;</span><br/><span class="hl-4">import</span><span class="hl-1"> { </span><span class="hl-5">identify</span><span class="hl-1"> } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&#39;@libp2p/identify&#39;</span><br/><span class="hl-4">import</span><span class="hl-1"> { </span><span class="hl-5">webRTC</span><span class="hl-1"> } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&#39;@libp2p/webrtc&#39;</span><br/><span class="hl-4">import</span><span class="hl-1"> { </span><span class="hl-5">webSockets</span><span class="hl-1"> } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&#39;@libp2p/websockets&#39;</span><br/><span class="hl-4">import</span><span class="hl-1"> </span><span class="hl-6">*</span><span class="hl-1"> </span><span class="hl-4">as</span><span class="hl-1"> </span><span class="hl-5">filters</span><span class="hl-1"> </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&#39;@libp2p/websockets/filters&#39;</span><br/><span class="hl-4">import</span><span class="hl-1"> { </span><span class="hl-5">WebRTC</span><span class="hl-1"> } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&#39;@multiformats/multiaddr-matcher&#39;</span><br/><span class="hl-4">import</span><span class="hl-1"> </span><span class="hl-5">delay</span><span class="hl-1"> </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&#39;delay&#39;</span><br/><span class="hl-4">import</span><span class="hl-1"> { </span><span class="hl-5">pipe</span><span class="hl-1"> } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&#39;it-pipe&#39;</span><br/><span class="hl-4">import</span><span class="hl-1"> { </span><span class="hl-5">createLibp2p</span><span class="hl-1"> } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&#39;libp2p&#39;</span><br/><span class="hl-4">import</span><span class="hl-1"> </span><span class="hl-4">type</span><span class="hl-1"> { </span><span class="hl-5">Multiaddr</span><span class="hl-1"> } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&#39;@multiformats/multiaddr&#39;</span><br/><br/><span class="hl-3">// the relay server listens on a transport dialable by the listener and the</span><br/><span class="hl-3">// dialer, and has a relay service configured</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">relay</span><span class="hl-1"> = </span><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-0">createLibp2p</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-5">addresses:</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-5">listen:</span><span class="hl-1"> [</span><span class="hl-2">&#39;/ip4/127.0.0.1/tcp/0/ws&#39;</span><span class="hl-1">]</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-5">transports:</span><span class="hl-1"> [</span><br/><span class="hl-1">    </span><span class="hl-0">webSockets</span><span class="hl-1">({</span><span class="hl-5">filter:</span><span class="hl-1"> </span><span class="hl-5">filters</span><span class="hl-1">.</span><span class="hl-5">all</span><span class="hl-1">})</span><br/><span class="hl-1">  ],</span><br/><span class="hl-1">  </span><span class="hl-5">connectionEncrypters:</span><span class="hl-1"> [</span><span class="hl-0">noise</span><span class="hl-1">()],</span><br/><span class="hl-1">  </span><span class="hl-5">streamMuxers:</span><span class="hl-1"> [</span><span class="hl-0">yamux</span><span class="hl-1">()],</span><br/><span class="hl-1">  </span><span class="hl-5">services:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-5">identify:</span><span class="hl-1"> </span><span class="hl-0">identify</span><span class="hl-1">(),</span><br/><span class="hl-1">    </span><span class="hl-5">relay:</span><span class="hl-1"> </span><span class="hl-0">circuitRelayServer</span><span class="hl-1">()</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">})</span><br/><br/><span class="hl-3">// the listener has a WebSocket transport to dial the relay, a Circuit Relay</span><br/><span class="hl-3">// transport to make a reservation, and a WebRTC transport to accept incoming</span><br/><span class="hl-3">// WebRTC connections</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">listener</span><span class="hl-1"> = </span><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-0">createLibp2p</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-5">addresses:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-5">listen:</span><span class="hl-1"> [</span><br/><span class="hl-1">      </span><span class="hl-2">&#39;/p2p-circuit&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-2">&#39;/webrtc&#39;</span><br/><span class="hl-1">    ]</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-5">transports:</span><span class="hl-1"> [</span><br/><span class="hl-1">    </span><span class="hl-0">webSockets</span><span class="hl-1">({</span><span class="hl-5">filter:</span><span class="hl-1"> </span><span class="hl-5">filters</span><span class="hl-1">.</span><span class="hl-5">all</span><span class="hl-1">}),</span><br/><span class="hl-1">    </span><span class="hl-0">webRTC</span><span class="hl-1">(),</span><br/><span class="hl-1">    </span><span class="hl-0">circuitRelayTransport</span><span class="hl-1">()</span><br/><span class="hl-1">  ],</span><br/><span class="hl-1">  </span><span class="hl-5">connectionEncrypters:</span><span class="hl-1"> [</span><span class="hl-0">noise</span><span class="hl-1">()],</span><br/><span class="hl-1">  </span><span class="hl-5">streamMuxers:</span><span class="hl-1"> [</span><span class="hl-0">yamux</span><span class="hl-1">()],</span><br/><span class="hl-1">  </span><span class="hl-5">services:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-5">identify:</span><span class="hl-1"> </span><span class="hl-0">identify</span><span class="hl-1">(),</span><br/><span class="hl-1">    </span><span class="hl-5">echo:</span><span class="hl-1"> </span><span class="hl-0">echo</span><span class="hl-1">()</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">})</span><br/><br/><span class="hl-3">// the listener dials the relay (or discovers a public relay via some other</span><br/><span class="hl-3">// method)</span><br/><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-5">listener</span><span class="hl-1">.</span><span class="hl-0">dial</span><span class="hl-1">(</span><span class="hl-5">relay</span><span class="hl-1">.</span><span class="hl-0">getMultiaddrs</span><span class="hl-1">(), {</span><br/><span class="hl-1">  </span><span class="hl-5">signal:</span><span class="hl-1"> </span><span class="hl-5">AbortSignal</span><span class="hl-1">.</span><span class="hl-0">timeout</span><span class="hl-1">(</span><span class="hl-14">5000</span><span class="hl-1">)</span><br/><span class="hl-1">})</span><br/><br/><span class="hl-6">let</span><span class="hl-1"> </span><span class="hl-5">webRTCMultiaddr</span><span class="hl-1">: </span><span class="hl-13">Multiaddr</span><span class="hl-1"> | </span><span class="hl-13">undefined</span><br/><br/><span class="hl-3">// wait for the listener to make a reservation on the relay</span><br/><span class="hl-4">while</span><span class="hl-1"> (</span><span class="hl-6">true</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-5">webRTCMultiaddr</span><span class="hl-1"> = </span><span class="hl-5">listener</span><span class="hl-1">.</span><span class="hl-0">getMultiaddrs</span><span class="hl-1">().</span><span class="hl-0">find</span><span class="hl-1">(</span><span class="hl-5">ma</span><span class="hl-1"> </span><span class="hl-6">=&gt;</span><span class="hl-1"> </span><span class="hl-5">WebRTC</span><span class="hl-1">.</span><span class="hl-0">matches</span><span class="hl-1">(</span><span class="hl-5">ma</span><span class="hl-1">))</span><br/><br/><span class="hl-1">  </span><span class="hl-4">if</span><span class="hl-1"> (</span><span class="hl-5">webRTCMultiaddr</span><span class="hl-1"> != </span><span class="hl-6">null</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-4">break</span><br/><span class="hl-1">  }</span><br/><br/><span class="hl-1">  </span><span class="hl-3">// try again later</span><br/><span class="hl-1">  </span><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-0">delay</span><span class="hl-1">(</span><span class="hl-14">1000</span><span class="hl-1">)</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-3">// the dialer has Circuit Relay, WebSocket and WebRTC transports to dial</span><br/><span class="hl-3">// the listener via the relay, complete the SDP handshake and establish a</span><br/><span class="hl-3">// direct WebRTC connection</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">dialer</span><span class="hl-1"> = </span><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-0">createLibp2p</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-5">transports:</span><span class="hl-1"> [</span><br/><span class="hl-1">    </span><span class="hl-0">webSockets</span><span class="hl-1">({</span><span class="hl-5">filter:</span><span class="hl-1"> </span><span class="hl-5">filters</span><span class="hl-1">.</span><span class="hl-5">all</span><span class="hl-1">}),</span><br/><span class="hl-1">    </span><span class="hl-0">webRTC</span><span class="hl-1">(),</span><br/><span class="hl-1">    </span><span class="hl-0">circuitRelayTransport</span><span class="hl-1">()</span><br/><span class="hl-1">  ],</span><br/><span class="hl-1">  </span><span class="hl-5">connectionEncrypters:</span><span class="hl-1"> [</span><span class="hl-0">noise</span><span class="hl-1">()],</span><br/><span class="hl-1">  </span><span class="hl-5">streamMuxers:</span><span class="hl-1"> [</span><span class="hl-0">yamux</span><span class="hl-1">()],</span><br/><span class="hl-1">  </span><span class="hl-5">services:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-5">identify:</span><span class="hl-1"> </span><span class="hl-0">identify</span><span class="hl-1">(),</span><br/><span class="hl-1">    </span><span class="hl-5">echo:</span><span class="hl-1"> </span><span class="hl-0">echo</span><span class="hl-1">()</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">})</span><br/><br/><span class="hl-3">// dial the listener and open an echo protocol stream</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">stream</span><span class="hl-1"> = </span><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-5">dialer</span><span class="hl-1">.</span><span class="hl-0">dialProtocol</span><span class="hl-1">(</span><span class="hl-5">webRTCMultiaddr</span><span class="hl-1">, </span><span class="hl-5">dialer</span><span class="hl-1">.</span><span class="hl-5">services</span><span class="hl-1">.</span><span class="hl-5">echo</span><span class="hl-1">.</span><span class="hl-5">protocol</span><span class="hl-1">, {</span><br/><span class="hl-1">  </span><span class="hl-5">signal:</span><span class="hl-1"> </span><span class="hl-5">AbortSignal</span><span class="hl-1">.</span><span class="hl-0">timeout</span><span class="hl-1">(</span><span class="hl-14">5000</span><span class="hl-1">)</span><br/><span class="hl-1">})</span><br/><br/><span class="hl-3">// we can now stop the relay</span><br/><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-5">relay</span><span class="hl-1">.</span><span class="hl-0">stop</span><span class="hl-1">()</span><br/><br/><span class="hl-3">// send/receive some data from the remote peer via a direct connection</span><br/><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-0">pipe</span><span class="hl-1">(</span><br/><span class="hl-1">  [</span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-0">TextEncoder</span><span class="hl-1">().</span><span class="hl-0">encode</span><span class="hl-1">(</span><span class="hl-2">&#39;hello world&#39;</span><span class="hl-1">)],</span><br/><span class="hl-1">  </span><span class="hl-5">stream</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-6">async</span><span class="hl-1"> </span><span class="hl-5">source</span><span class="hl-1"> </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">for</span><span class="hl-1"> </span><span class="hl-4">await</span><span class="hl-1"> (</span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">buf</span><span class="hl-1"> </span><span class="hl-6">of</span><span class="hl-1"> </span><span class="hl-5">source</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-5">console</span><span class="hl-1">.</span><span class="hl-0">info</span><span class="hl-1">(</span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-0">TextDecoder</span><span class="hl-1">().</span><span class="hl-0">decode</span><span class="hl-1">(</span><span class="hl-5">buf</span><span class="hl-1">.</span><span class="hl-0">subarray</span><span class="hl-1">()))</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">)</span>
</code><button>Copy</button></pre>
<h4>Example: WebRTC Direct</h4><p>At the time of writing WebRTC Direct is dial-only in browsers and unsupported in Node.js.</p>
<p>The only implementation that supports a WebRTC Direct listener is go-libp2p and it&#39;s not yet enabled by default.</p>
<pre><code class="language-TypeScript"><span class="hl-4">import</span><span class="hl-1"> { </span><span class="hl-5">createLibp2p</span><span class="hl-1"> } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&#39;libp2p&#39;</span><br/><span class="hl-4">import</span><span class="hl-1"> { </span><span class="hl-5">multiaddr</span><span class="hl-1"> } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&#39;@multiformats/multiaddr&#39;</span><br/><span class="hl-4">import</span><span class="hl-1"> { </span><span class="hl-5">pipe</span><span class="hl-1"> } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&#39;it-pipe&#39;</span><br/><span class="hl-4">import</span><span class="hl-1"> { </span><span class="hl-5">fromString</span><span class="hl-1">, </span><span class="hl-5">toString</span><span class="hl-1"> } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&#39;uint8arrays&#39;</span><br/><span class="hl-4">import</span><span class="hl-1"> { </span><span class="hl-5">webRTCDirect</span><span class="hl-1"> } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&#39;@libp2p/webrtc&#39;</span><br/><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">listener</span><span class="hl-1"> = </span><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-0">createLibp2p</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-5">addresses:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-5">listen:</span><span class="hl-1"> [</span><br/><span class="hl-1">      </span><span class="hl-2">&#39;/ip4/0.0.0.0/udp/0/webrtc-direct&#39;</span><br/><span class="hl-1">    ]</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-5">transports:</span><span class="hl-1"> [</span><br/><span class="hl-1">    </span><span class="hl-0">webRTCDirect</span><span class="hl-1">()</span><br/><span class="hl-1">  ]</span><br/><span class="hl-1">})</span><br/><br/><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-5">listener</span><span class="hl-1">.</span><span class="hl-0">start</span><span class="hl-1">()</span><br/><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">dialer</span><span class="hl-1"> = </span><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-0">createLibp2p</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-5">transports:</span><span class="hl-1"> [</span><br/><span class="hl-1">    </span><span class="hl-0">webRTCDirect</span><span class="hl-1">()</span><br/><span class="hl-1">  ]</span><br/><span class="hl-1">})</span><br/><br/><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-5">dialer</span><span class="hl-1">.</span><span class="hl-0">start</span><span class="hl-1">()</span><br/><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">stream</span><span class="hl-1"> = </span><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-5">dialer</span><span class="hl-1">.</span><span class="hl-0">dialProtocol</span><span class="hl-1">(</span><span class="hl-5">listener</span><span class="hl-1">.</span><span class="hl-0">getMultiaddrs</span><span class="hl-1">(), </span><span class="hl-2">&#39;/my-protocol/1.0.0&#39;</span><span class="hl-1">, {</span><br/><span class="hl-1">  </span><span class="hl-5">signal:</span><span class="hl-1"> </span><span class="hl-5">AbortSignal</span><span class="hl-1">.</span><span class="hl-0">timeout</span><span class="hl-1">(</span><span class="hl-14">10_000</span><span class="hl-1">)</span><br/><span class="hl-1">})</span><br/><br/><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-0">pipe</span><span class="hl-1">(</span><br/><span class="hl-1">  [</span><span class="hl-0">fromString</span><span class="hl-1">(</span><span class="hl-2">`Hello js-libp2p-webrtc</span><span class="hl-18">\n</span><span class="hl-2">`</span><span class="hl-1">)],</span><br/><span class="hl-1">  </span><span class="hl-5">stream</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-6">async</span><span class="hl-1"> </span><span class="hl-6">function</span><span class="hl-1"> (</span><span class="hl-5">source</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-4">for</span><span class="hl-1"> </span><span class="hl-4">await</span><span class="hl-1"> (</span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">buf</span><span class="hl-1"> </span><span class="hl-6">of</span><span class="hl-1"> </span><span class="hl-5">source</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-5">console</span><span class="hl-1">.</span><span class="hl-0">info</span><span class="hl-1">(</span><span class="hl-0">toString</span><span class="hl-1">(</span><span class="hl-5">buf</span><span class="hl-1">.</span><span class="hl-0">subarray</span><span class="hl-1">()))</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">)</span>
</code><button>Copy</button></pre>
</div></section><section class="tsd-panel tsd-typography"><a id="md:libp2pwebrtc" class="tsd-anchor"></a><h1><a href="#md:libp2pwebrtc">@libp2p/webrtc</a></h1><p><a href="http://libp2p.io/"><img src="https://img.shields.io/badge/project-libp2p-yellow.svg?style=flat-square" alt="libp2p.io"></a>
<a href="https://discuss.libp2p.io"><img src="https://img.shields.io/discourse/https/discuss.libp2p.io/posts.svg?style=flat-square" alt="Discuss"></a>
<a href="https://codecov.io/gh/libp2p/js-libp2p"><img src="https://img.shields.io/codecov/c/github/libp2p/js-libp2p.svg?style=flat-square" alt="codecov"></a>
<a href="https://github.com/libp2p/js-libp2p/actions/workflows/main.yml?query=branch%3Amain"><img src="https://img.shields.io/github/actions/workflow/status/libp2p/js-libp2p/main.yml?branch=main&style=flat-square" alt="CI"></a></p>
<blockquote>
<p>A libp2p transport using WebRTC connections</p>
</blockquote>
<a id="md:about" class="tsd-anchor"></a><h1><a href="#md:about">About</a></h1><!--

!IMPORTANT!

Everything in this README between "# About" and "# Install" is automatically
generated and will be overwritten the next time the doc generator is run.

To make changes to this section, please update the  section
of src/index.js or src/index.ts

To experiment with formatting, please run "npm run docs" from the root of this
repo and examine the changes made.

-->

<p>A <a href="https://docs.libp2p.io/concepts/transports/overview/">libp2p transport</a> based on <a href="https://webrtc.org/">WebRTC datachannels</a>.</p>
<p><a href="https://www.w3.org/TR/webrtc/">WebRTC</a> is a specification that allows real-time communication between nodes - it&#39;s commonly used in browser video conferencing applications but it also provides a reliable data transport mechanism called <a href="https://www.w3.org/TR/webrtc/#peer-to-peer-data-api">data channels</a> which libp2p uses to facilitate <a href="https://docs.libp2p.io/concepts/multiplex/overview/">protocol streams</a> between peers.</p>
<p>There are two transports exposed by this module, <a href="https://github.com/libp2p/specs/blob/master/webrtc/webrtc.md">webRTC</a> and <a href="https://github.com/libp2p/specs/blob/master/webrtc/webrtc-direct.md">webRTCDirect</a>.</p>
<a id="md:webrtc-vs-webrtc-direct" class="tsd-anchor"></a><h2><a href="#md:webrtc-vs-webrtc-direct">WebRTC vs WebRTC Direct</a></h2><p>The connection establishment phase of WebRTC involves a handshake using <a href="https://en.wikipedia.org/wiki/Session_Description_Protocol">SDP</a> during which two peers will exchange information such as open ports, network addresses and required capabilities.</p>
<p>A third party is usually necessary to carry out this handshake, forwarding messages between the two peers until they can make a direct connection between themselves.</p>
<p>The WebRTC transport uses libp2p <a href="https://docs.libp2p.io/concepts/nat/circuit-relay/">Circuit Relay</a>s to forward SDP messages. Once a direct connection is formed the relay plays no further part in the exchange.</p>
<p>WebRTC Direct uses a technique known as <a href="https://webrtchacks.com/not-a-guide-to-sdp-munging/">SDP munging</a> to skip the handshake step, instead encoding enough information in the connection request that the responder can derive what would have been in the handshake messages and so requires no third parties to establish a connection.</p>
<p>A WebRTC Direct multiaddr also includes a certhash of the target peer - this is used to allow opening a connection to the remote, which would otherwise be denied due to use of a self-signed certificate.</p>
<p>In both cases, once the connection is established a <a href="https://noiseprotocol.org/noise.html">Noise handshake</a> is carried out to ensure that the remote peer has the private key that corresponds to the public key that makes up their PeerId, giving you both encryption and authentication.</p>
<a id="md:example---webrtc" class="tsd-anchor"></a><h2><a href="#md:example---webrtc">Example - WebRTC</a></h2><p>WebRTC requires use of a relay to connect two nodes. The listener first discovers a relay server and makes a reservation, then the dialer can connect via the relayed address.</p>
<pre><code class="language-TypeScript"><span class="hl-4">import</span><span class="hl-1"> { </span><span class="hl-5">noise</span><span class="hl-1"> } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&#39;@chainsafe/libp2p-noise&#39;</span><br/><span class="hl-4">import</span><span class="hl-1"> { </span><span class="hl-5">yamux</span><span class="hl-1"> } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&#39;@chainsafe/libp2p-yamux&#39;</span><br/><span class="hl-4">import</span><span class="hl-1"> { </span><span class="hl-5">echo</span><span class="hl-1"> } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&#39;@libp2p/echo&#39;</span><br/><span class="hl-4">import</span><span class="hl-1"> { </span><span class="hl-5">circuitRelayTransport</span><span class="hl-1">, </span><span class="hl-5">circuitRelayServer</span><span class="hl-1"> } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&#39;@libp2p/circuit-relay-v2&#39;</span><br/><span class="hl-4">import</span><span class="hl-1"> { </span><span class="hl-5">identify</span><span class="hl-1"> } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&#39;@libp2p/identify&#39;</span><br/><span class="hl-4">import</span><span class="hl-1"> { </span><span class="hl-5">webRTC</span><span class="hl-1"> } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&#39;@libp2p/webrtc&#39;</span><br/><span class="hl-4">import</span><span class="hl-1"> { </span><span class="hl-5">webSockets</span><span class="hl-1"> } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&#39;@libp2p/websockets&#39;</span><br/><span class="hl-4">import</span><span class="hl-1"> </span><span class="hl-6">*</span><span class="hl-1"> </span><span class="hl-4">as</span><span class="hl-1"> </span><span class="hl-5">filters</span><span class="hl-1"> </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&#39;@libp2p/websockets/filters&#39;</span><br/><span class="hl-4">import</span><span class="hl-1"> { </span><span class="hl-5">WebRTC</span><span class="hl-1"> } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&#39;@multiformats/multiaddr-matcher&#39;</span><br/><span class="hl-4">import</span><span class="hl-1"> </span><span class="hl-5">delay</span><span class="hl-1"> </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&#39;delay&#39;</span><br/><span class="hl-4">import</span><span class="hl-1"> { </span><span class="hl-5">pipe</span><span class="hl-1"> } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&#39;it-pipe&#39;</span><br/><span class="hl-4">import</span><span class="hl-1"> { </span><span class="hl-5">createLibp2p</span><span class="hl-1"> } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&#39;libp2p&#39;</span><br/><span class="hl-4">import</span><span class="hl-1"> </span><span class="hl-4">type</span><span class="hl-1"> { </span><span class="hl-5">Multiaddr</span><span class="hl-1"> } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&#39;@multiformats/multiaddr&#39;</span><br/><br/><span class="hl-3">// the relay server listens on a transport dialable by the listener and the</span><br/><span class="hl-3">// dialer, and has a relay service configured</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">relay</span><span class="hl-1"> = </span><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-0">createLibp2p</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-5">addresses:</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-5">listen:</span><span class="hl-1"> [</span><span class="hl-2">&#39;/ip4/127.0.0.1/tcp/0/ws&#39;</span><span class="hl-1">]</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-5">transports:</span><span class="hl-1"> [</span><br/><span class="hl-1">    </span><span class="hl-0">webSockets</span><span class="hl-1">({</span><span class="hl-5">filter:</span><span class="hl-1"> </span><span class="hl-5">filters</span><span class="hl-1">.</span><span class="hl-5">all</span><span class="hl-1">})</span><br/><span class="hl-1">  ],</span><br/><span class="hl-1">  </span><span class="hl-5">connectionEncrypters:</span><span class="hl-1"> [</span><span class="hl-0">noise</span><span class="hl-1">()],</span><br/><span class="hl-1">  </span><span class="hl-5">streamMuxers:</span><span class="hl-1"> [</span><span class="hl-0">yamux</span><span class="hl-1">()],</span><br/><span class="hl-1">  </span><span class="hl-5">services:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-5">identify:</span><span class="hl-1"> </span><span class="hl-0">identify</span><span class="hl-1">(),</span><br/><span class="hl-1">    </span><span class="hl-5">relay:</span><span class="hl-1"> </span><span class="hl-0">circuitRelayServer</span><span class="hl-1">()</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">})</span><br/><br/><span class="hl-3">// the listener has a WebSocket transport to dial the relay, a Circuit Relay</span><br/><span class="hl-3">// transport to make a reservation, and a WebRTC transport to accept incoming</span><br/><span class="hl-3">// WebRTC connections</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">listener</span><span class="hl-1"> = </span><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-0">createLibp2p</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-5">addresses:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-5">listen:</span><span class="hl-1"> [</span><br/><span class="hl-1">      </span><span class="hl-2">&#39;/p2p-circuit&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-2">&#39;/webrtc&#39;</span><br/><span class="hl-1">    ]</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-5">transports:</span><span class="hl-1"> [</span><br/><span class="hl-1">    </span><span class="hl-0">webSockets</span><span class="hl-1">({</span><span class="hl-5">filter:</span><span class="hl-1"> </span><span class="hl-5">filters</span><span class="hl-1">.</span><span class="hl-5">all</span><span class="hl-1">}),</span><br/><span class="hl-1">    </span><span class="hl-0">webRTC</span><span class="hl-1">(),</span><br/><span class="hl-1">    </span><span class="hl-0">circuitRelayTransport</span><span class="hl-1">()</span><br/><span class="hl-1">  ],</span><br/><span class="hl-1">  </span><span class="hl-5">connectionEncrypters:</span><span class="hl-1"> [</span><span class="hl-0">noise</span><span class="hl-1">()],</span><br/><span class="hl-1">  </span><span class="hl-5">streamMuxers:</span><span class="hl-1"> [</span><span class="hl-0">yamux</span><span class="hl-1">()],</span><br/><span class="hl-1">  </span><span class="hl-5">services:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-5">identify:</span><span class="hl-1"> </span><span class="hl-0">identify</span><span class="hl-1">(),</span><br/><span class="hl-1">    </span><span class="hl-5">echo:</span><span class="hl-1"> </span><span class="hl-0">echo</span><span class="hl-1">()</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">})</span><br/><br/><span class="hl-3">// the listener dials the relay (or discovers a public relay via some other</span><br/><span class="hl-3">// method)</span><br/><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-5">listener</span><span class="hl-1">.</span><span class="hl-0">dial</span><span class="hl-1">(</span><span class="hl-5">relay</span><span class="hl-1">.</span><span class="hl-0">getMultiaddrs</span><span class="hl-1">(), {</span><br/><span class="hl-1">  </span><span class="hl-5">signal:</span><span class="hl-1"> </span><span class="hl-5">AbortSignal</span><span class="hl-1">.</span><span class="hl-0">timeout</span><span class="hl-1">(</span><span class="hl-14">5000</span><span class="hl-1">)</span><br/><span class="hl-1">})</span><br/><br/><span class="hl-6">let</span><span class="hl-1"> </span><span class="hl-5">webRTCMultiaddr</span><span class="hl-1">: </span><span class="hl-13">Multiaddr</span><span class="hl-1"> | </span><span class="hl-13">undefined</span><br/><br/><span class="hl-3">// wait for the listener to make a reservation on the relay</span><br/><span class="hl-4">while</span><span class="hl-1"> (</span><span class="hl-6">true</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-5">webRTCMultiaddr</span><span class="hl-1"> = </span><span class="hl-5">listener</span><span class="hl-1">.</span><span class="hl-0">getMultiaddrs</span><span class="hl-1">().</span><span class="hl-0">find</span><span class="hl-1">(</span><span class="hl-5">ma</span><span class="hl-1"> </span><span class="hl-6">=&gt;</span><span class="hl-1"> </span><span class="hl-5">WebRTC</span><span class="hl-1">.</span><span class="hl-0">matches</span><span class="hl-1">(</span><span class="hl-5">ma</span><span class="hl-1">))</span><br/><br/><span class="hl-1">  </span><span class="hl-4">if</span><span class="hl-1"> (</span><span class="hl-5">webRTCMultiaddr</span><span class="hl-1"> != </span><span class="hl-6">null</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-4">break</span><br/><span class="hl-1">  }</span><br/><br/><span class="hl-1">  </span><span class="hl-3">// try again later</span><br/><span class="hl-1">  </span><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-0">delay</span><span class="hl-1">(</span><span class="hl-14">1000</span><span class="hl-1">)</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-3">// the dialer has Circuit Relay, WebSocket and WebRTC transports to dial</span><br/><span class="hl-3">// the listener via the relay, complete the SDP handshake and establish a</span><br/><span class="hl-3">// direct WebRTC connection</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">dialer</span><span class="hl-1"> = </span><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-0">createLibp2p</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-5">transports:</span><span class="hl-1"> [</span><br/><span class="hl-1">    </span><span class="hl-0">webSockets</span><span class="hl-1">({</span><span class="hl-5">filter:</span><span class="hl-1"> </span><span class="hl-5">filters</span><span class="hl-1">.</span><span class="hl-5">all</span><span class="hl-1">}),</span><br/><span class="hl-1">    </span><span class="hl-0">webRTC</span><span class="hl-1">(),</span><br/><span class="hl-1">    </span><span class="hl-0">circuitRelayTransport</span><span class="hl-1">()</span><br/><span class="hl-1">  ],</span><br/><span class="hl-1">  </span><span class="hl-5">connectionEncrypters:</span><span class="hl-1"> [</span><span class="hl-0">noise</span><span class="hl-1">()],</span><br/><span class="hl-1">  </span><span class="hl-5">streamMuxers:</span><span class="hl-1"> [</span><span class="hl-0">yamux</span><span class="hl-1">()],</span><br/><span class="hl-1">  </span><span class="hl-5">services:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-5">identify:</span><span class="hl-1"> </span><span class="hl-0">identify</span><span class="hl-1">(),</span><br/><span class="hl-1">    </span><span class="hl-5">echo:</span><span class="hl-1"> </span><span class="hl-0">echo</span><span class="hl-1">()</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">})</span><br/><br/><span class="hl-3">// dial the listener and open an echo protocol stream</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">stream</span><span class="hl-1"> = </span><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-5">dialer</span><span class="hl-1">.</span><span class="hl-0">dialProtocol</span><span class="hl-1">(</span><span class="hl-5">webRTCMultiaddr</span><span class="hl-1">, </span><span class="hl-5">dialer</span><span class="hl-1">.</span><span class="hl-5">services</span><span class="hl-1">.</span><span class="hl-5">echo</span><span class="hl-1">.</span><span class="hl-5">protocol</span><span class="hl-1">, {</span><br/><span class="hl-1">  </span><span class="hl-5">signal:</span><span class="hl-1"> </span><span class="hl-5">AbortSignal</span><span class="hl-1">.</span><span class="hl-0">timeout</span><span class="hl-1">(</span><span class="hl-14">5000</span><span class="hl-1">)</span><br/><span class="hl-1">})</span><br/><br/><span class="hl-3">// we can now stop the relay</span><br/><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-5">relay</span><span class="hl-1">.</span><span class="hl-0">stop</span><span class="hl-1">()</span><br/><br/><span class="hl-3">// send/receive some data from the remote peer via a direct connection</span><br/><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-0">pipe</span><span class="hl-1">(</span><br/><span class="hl-1">  [</span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-0">TextEncoder</span><span class="hl-1">().</span><span class="hl-0">encode</span><span class="hl-1">(</span><span class="hl-2">&#39;hello world&#39;</span><span class="hl-1">)],</span><br/><span class="hl-1">  </span><span class="hl-5">stream</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-6">async</span><span class="hl-1"> </span><span class="hl-5">source</span><span class="hl-1"> </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">for</span><span class="hl-1"> </span><span class="hl-4">await</span><span class="hl-1"> (</span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">buf</span><span class="hl-1"> </span><span class="hl-6">of</span><span class="hl-1"> </span><span class="hl-5">source</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-5">console</span><span class="hl-1">.</span><span class="hl-0">info</span><span class="hl-1">(</span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-0">TextDecoder</span><span class="hl-1">().</span><span class="hl-0">decode</span><span class="hl-1">(</span><span class="hl-5">buf</span><span class="hl-1">.</span><span class="hl-0">subarray</span><span class="hl-1">()))</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">)</span>
</code><button>Copy</button></pre>
<a id="md:example---webrtc-direct" class="tsd-anchor"></a><h2><a href="#md:example---webrtc-direct">Example - WebRTC Direct</a></h2><p>At the time of writing WebRTC Direct is dial-only in browsers and unsupported in Node.js.</p>
<p>The only implementation that supports a WebRTC Direct listener is go-libp2p and it&#39;s not yet enabled by default.</p>
<pre><code class="language-TypeScript"><span class="hl-4">import</span><span class="hl-1"> { </span><span class="hl-5">createLibp2p</span><span class="hl-1"> } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&#39;libp2p&#39;</span><br/><span class="hl-4">import</span><span class="hl-1"> { </span><span class="hl-5">multiaddr</span><span class="hl-1"> } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&#39;@multiformats/multiaddr&#39;</span><br/><span class="hl-4">import</span><span class="hl-1"> { </span><span class="hl-5">pipe</span><span class="hl-1"> } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&#39;it-pipe&#39;</span><br/><span class="hl-4">import</span><span class="hl-1"> { </span><span class="hl-5">fromString</span><span class="hl-1">, </span><span class="hl-5">toString</span><span class="hl-1"> } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&#39;uint8arrays&#39;</span><br/><span class="hl-4">import</span><span class="hl-1"> { </span><span class="hl-5">webRTCDirect</span><span class="hl-1"> } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&#39;@libp2p/webrtc&#39;</span><br/><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">listener</span><span class="hl-1"> = </span><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-0">createLibp2p</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-5">addresses:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-5">listen:</span><span class="hl-1"> [</span><br/><span class="hl-1">      </span><span class="hl-2">&#39;/ip4/0.0.0.0/udp/0/webrtc-direct&#39;</span><br/><span class="hl-1">    ]</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-5">transports:</span><span class="hl-1"> [</span><br/><span class="hl-1">    </span><span class="hl-0">webRTCDirect</span><span class="hl-1">()</span><br/><span class="hl-1">  ]</span><br/><span class="hl-1">})</span><br/><br/><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-5">listener</span><span class="hl-1">.</span><span class="hl-0">start</span><span class="hl-1">()</span><br/><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">dialer</span><span class="hl-1"> = </span><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-0">createLibp2p</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-5">transports:</span><span class="hl-1"> [</span><br/><span class="hl-1">    </span><span class="hl-0">webRTCDirect</span><span class="hl-1">()</span><br/><span class="hl-1">  ]</span><br/><span class="hl-1">})</span><br/><br/><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-5">dialer</span><span class="hl-1">.</span><span class="hl-0">start</span><span class="hl-1">()</span><br/><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">stream</span><span class="hl-1"> = </span><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-5">dialer</span><span class="hl-1">.</span><span class="hl-0">dialProtocol</span><span class="hl-1">(</span><span class="hl-5">listener</span><span class="hl-1">.</span><span class="hl-0">getMultiaddrs</span><span class="hl-1">(), </span><span class="hl-2">&#39;/my-protocol/1.0.0&#39;</span><span class="hl-1">, {</span><br/><span class="hl-1">  </span><span class="hl-5">signal:</span><span class="hl-1"> </span><span class="hl-5">AbortSignal</span><span class="hl-1">.</span><span class="hl-0">timeout</span><span class="hl-1">(</span><span class="hl-14">10_000</span><span class="hl-1">)</span><br/><span class="hl-1">})</span><br/><br/><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-0">pipe</span><span class="hl-1">(</span><br/><span class="hl-1">  [</span><span class="hl-0">fromString</span><span class="hl-1">(</span><span class="hl-2">`Hello js-libp2p-webrtc</span><span class="hl-18">\n</span><span class="hl-2">`</span><span class="hl-1">)],</span><br/><span class="hl-1">  </span><span class="hl-5">stream</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-6">async</span><span class="hl-1"> </span><span class="hl-6">function</span><span class="hl-1"> (</span><span class="hl-5">source</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-4">for</span><span class="hl-1"> </span><span class="hl-4">await</span><span class="hl-1"> (</span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">buf</span><span class="hl-1"> </span><span class="hl-6">of</span><span class="hl-1"> </span><span class="hl-5">source</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-5">console</span><span class="hl-1">.</span><span class="hl-0">info</span><span class="hl-1">(</span><span class="hl-0">toString</span><span class="hl-1">(</span><span class="hl-5">buf</span><span class="hl-1">.</span><span class="hl-0">subarray</span><span class="hl-1">()))</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">)</span>
</code><button>Copy</button></pre>
<a id="md:install" class="tsd-anchor"></a><h1><a href="#md:install">Install</a></h1><pre><code class="language-console"><span class="hl-1">$ npm i @libp2p/webrtc</span>
</code><button>Copy</button></pre>
<a id="md:browser-ltscriptgt-tag" class="tsd-anchor"></a><h2><a href="#md:browser-ltscriptgt-tag">Browser <code>&lt;script&gt;</code> tag</a></h2><p>Loading this module through a script tag will make its exports available as <code>Libp2pWebrtc</code> in the global namespace.</p>
<pre><code class="language-html"><span class="hl-8">&lt;</span><span class="hl-9">script</span><span class="hl-10"> </span><span class="hl-11">src</span><span class="hl-10">=</span><span class="hl-12">&quot;https://unpkg.com/@libp2p/webrtc/dist/index.min.js&quot;</span><span class="hl-8">&gt;&lt;/</span><span class="hl-9">script</span><span class="hl-8">&gt;</span>
</code><button>Copy</button></pre>
<a id="md:api-docs" class="tsd-anchor"></a><h1><a href="#md:api-docs">API Docs</a></h1><ul>
<li><a href="https://libp2p.github.io/js-libp2p/modules/_libp2p_webrtc.html">https://libp2p.github.io/js-libp2p/modules/_libp2p_webrtc.html</a></li>
</ul>
<a id="md:license" class="tsd-anchor"></a><h1><a href="#md:license">License</a></h1><p>Licensed under either of</p>
<ul>
<li>Apache 2.0, (<a href="https://github.com/libp2p/js-libp2p/blob/main/packages/transport-webrtc/LICENSE-APACHE">LICENSE-APACHE</a> / <a href="http://www.apache.org/licenses/LICENSE-2.0">http://www.apache.org/licenses/LICENSE-2.0</a>)</li>
<li>MIT (<a href="https://github.com/libp2p/js-libp2p/blob/main/packages/transport-webrtc/LICENSE-MIT">LICENSE-MIT</a> / <a href="http://opensource.org/licenses/MIT">http://opensource.org/licenses/MIT</a>)</li>
</ul>
<a id="md:contribution" class="tsd-anchor"></a><h1><a href="#md:contribution">Contribution</a></h1><p>Unless you explicitly state otherwise, any contribution intentionally submitted for inclusion in the work by you, as defined in the Apache-2.0 license, shall be dual licensed as above, without any additional terms or conditions.</p>
</section><section class="tsd-panel-group tsd-index-group"><section class="tsd-panel tsd-index-panel"><h3 class="tsd-index-heading uppercase">Index</h3><section class="tsd-index-section"><h3 class="tsd-index-heading">Interfaces</h3><div class="tsd-index-list"><a href="../interfaces/_libp2p_webrtc.DataChannelOptions.html" class="tsd-index-link"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-256"></use></svg><span>Data<wbr/>Channel<wbr/>Options</span></a>
<a href="../interfaces/_libp2p_webrtc.TransportCertificate.html" class="tsd-index-link"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-256"></use></svg><span>Transport<wbr/>Certificate</span></a>
<a href="../interfaces/_libp2p_webrtc.WebRTCDirectTransportComponents.html" class="tsd-index-link"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-256"></use></svg><span>WebRTCDirect<wbr/>Transport<wbr/>Components</span></a>
<a href="../interfaces/_libp2p_webrtc.WebRTCTransportComponents.html" class="tsd-index-link"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-256"></use></svg><span>WebRTCTransport<wbr/>Components</span></a>
<a href="../interfaces/_libp2p_webrtc.WebRTCTransportDirectInit.html" class="tsd-index-link"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-256"></use></svg><span>WebRTCTransport<wbr/>Direct<wbr/>Init</span></a>
<a href="../interfaces/_libp2p_webrtc.WebRTCTransportInit.html" class="tsd-index-link"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-256"></use></svg><span>WebRTCTransport<wbr/>Init</span></a>
</div></section><section class="tsd-index-section"><h3 class="tsd-index-heading">Functions</h3><div class="tsd-index-list"><a href="../functions/_libp2p_webrtc.webRTC.html" class="tsd-index-link"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-64"></use></svg><span>webRTC</span></a>
<a href="../functions/_libp2p_webrtc.webRTCDirect.html" class="tsd-index-link"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-64"></use></svg><span>webRTCDirect</span></a>
</div></section></section></section></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-index-accordion"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-filter-visibility"><h4 class="uppercase">Member Visibility</h4><form><ul id="tsd-filter-options"><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-private" name="private"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Private</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></form></div><div class="tsd-theme-toggle"><h4 class="uppercase">Theme</h4><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-index-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>On This Page</h3></summary><div class="tsd-accordion-details"><ul><li><a href="#md:webrtc-vs-webrtc-direct"><span>WebRTC vs <wbr/>WebRTC <wbr/>Direct</span></a></li></ul><a href="#md:libp2pwebrtc"><span>@libp2p/webrtc</span></a><a href="#md:about"><span>About</span></a><ul><li><a href="#md:webrtc-vs-webrtc-direct"><span>WebRTC vs <wbr/>WebRTC <wbr/>Direct</span></a></li><li><a href="#md:example---webrtc"><span>Example -<wbr/> <wbr/>WebRTC</span></a></li><li><a href="#md:example---webrtc-direct"><span>Example -<wbr/> <wbr/>WebRTC <wbr/>Direct</span></a></li></ul><a href="#md:install"><span>Install</span></a><ul><li><a href="#md:browser-ltscriptgt-tag"><span>Browser &lt;script&gt; tag</span></a></li></ul><a href="#md:api-docs"><span>API <wbr/>Docs</span></a><a href="#md:license"><span>License</span></a><a href="#md:contribution"><span>Contribution</span></a></div></details></div><div class="site-menu"><nav class="tsd-navigation"><a href="../index.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-1"></use></svg><span>libp2p</span></a><ul class="tsd-small-nested-navigation" id="tsd-nav-container" data-base=".."><li>Loading...</li></ul></nav></div></div></div><footer><p class="tsd-generator">Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></footer><div class="overlay"></div></body></html>