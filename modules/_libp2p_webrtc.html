<!DOCTYPE html><html class="default" lang="en" data-base="../"><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>@libp2p/webrtc | libp2p</title><meta name="description" content="Documentation for libp2p"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="../assets/style.css"/><link rel="stylesheet" href="../assets/highlight.css"/><script defer src="../assets/main.js"></script><script async src="../assets/icons.js" id="tsd-icons-script"></script><script async src="../assets/search.js" id="tsd-search-script"></script><script async src="../assets/navigation.js" id="tsd-nav-script"></script><script async src="../assets/hierarchy.js" id="tsd-hierarchy-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => window.app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><a href="../index.html" class="title">libp2p</a><div id="tsd-toolbar-links"></div><button id="tsd-search-trigger" class="tsd-widget" aria-label="Search"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-search"></use></svg></button><dialog id="tsd-search" aria-label="Search"><input role="combobox" id="tsd-search-input" aria-controls="tsd-search-results" aria-autocomplete="list" aria-expanded="true" autocapitalize="off" autocomplete="off" placeholder="Search the docs" maxLength="100"/><ul role="listbox" id="tsd-search-results"></ul><div id="tsd-search-status" aria-live="polite" aria-atomic="true"><div>Preparing search index...</div></div></dialog><a href="#" class="tsd-widget menu" id="tsd-toolbar-menu-trigger" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-menu"></use></svg></a></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><ul class="tsd-breadcrumb" aria-label="Breadcrumb"><li><a href="" aria-current="page">@libp2p/webrtc</a></li></ul><h1>Module @libp2p/webrtc</h1></div><section class="tsd-panel tsd-comment"><div class="tsd-comment tsd-typography"><p>A <a href="https://docs.libp2p.io/concepts/transports/overview/">libp2p transport</a> based on <a href="https://webrtc.org/">WebRTC data channels</a>.</p>
<p><a href="https://www.w3.org/TR/webrtc/">WebRTC</a> is a specification that allows real-time communication between nodes - it's commonly used in browser video conferencing applications but it also provides a reliable data transport mechanism called <a href="https://www.w3.org/TR/webrtc/#peer-to-peer-data-api">data channels</a> which libp2p uses to facilitate <a href="https://docs.libp2p.io/concepts/multiplex/overview/">protocol streams</a> between peers.</p>
<p>There are two transports exposed by this module, <a href="https://github.com/libp2p/specs/blob/master/webrtc/webrtc.md">webRTC</a> and <a href="https://github.com/libp2p/specs/blob/master/webrtc/webrtc-direct.md">webRTCDirect</a>.</p>
<h2 id="webrtc-vs-webrtc-direct" class="tsd-anchor-link">WebRTC vs WebRTC Direct<a href="#webrtc-vs-webrtc-direct" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The connection establishment phase of WebRTC involves a handshake using <a href="https://en.wikipedia.org/wiki/Session_Description_Protocol">SDP</a> during which two peers will exchange information such as open ports, network addresses and required capabilities.</p>
<p>A third party is usually necessary to carry out this handshake, forwarding messages between the two peers until they can make a direct connection between themselves.</p>
<p>The WebRTC transport uses libp2p <a href="https://docs.libp2p.io/concepts/nat/circuit-relay/">Circuit Relay</a>s to forward SDP messages. Once a direct connection is formed the relay plays no further part in the exchange.</p>
<p>WebRTC Direct uses a technique known as <a href="https://webrtchacks.com/not-a-guide-to-sdp-munging/">SDP munging</a> to skip the handshake step, instead encoding enough information in the connection request that the responder can derive what would have been in the handshake messages and so requires no third parties to establish a connection.</p>
<p>A WebRTC Direct multiaddr also includes a certhash of the target peer - this is used to allow opening a connection to the remote, which would otherwise be denied due to use of a self-signed certificate.</p>
<p>In both cases, once the connection is established a <a href="https://noiseprotocol.org/noise.html">Noise handshake</a> is carried out to ensure that the remote peer has the private key that corresponds to the public key that makes up their PeerId, giving you both encryption and authentication.</p>
</div><div class="tsd-comment tsd-typography"><div class="tsd-tag-example"><h4 class="tsd-anchor-link" id="example-webrtc">Example: WebRTC<a href="#example-webrtc" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><p>WebRTC requires use of a relay to connect two nodes. The listener first discovers a relay server and makes a reservation, then the dialer can connect via the relayed address.</p>
<pre><code class="TypeScript"><span class="hl-4">import</span><span class="hl-1"> { </span><span class="hl-5">noise</span><span class="hl-1"> } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&#39;@chainsafe/libp2p-noise&#39;</span><br/><span class="hl-4">import</span><span class="hl-1"> { </span><span class="hl-5">yamux</span><span class="hl-1"> } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&#39;@chainsafe/libp2p-yamux&#39;</span><br/><span class="hl-4">import</span><span class="hl-1"> { </span><span class="hl-5">echo</span><span class="hl-1"> } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&#39;@libp2p/echo&#39;</span><br/><span class="hl-4">import</span><span class="hl-1"> { </span><span class="hl-5">circuitRelayTransport</span><span class="hl-1">, </span><span class="hl-5">circuitRelayServer</span><span class="hl-1"> } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&#39;@libp2p/circuit-relay-v2&#39;</span><br/><span class="hl-4">import</span><span class="hl-1"> { </span><span class="hl-5">identify</span><span class="hl-1"> } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&#39;@libp2p/identify&#39;</span><br/><span class="hl-4">import</span><span class="hl-1"> { </span><span class="hl-5">webRTC</span><span class="hl-1"> } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&#39;@libp2p/webrtc&#39;</span><br/><span class="hl-4">import</span><span class="hl-1"> { </span><span class="hl-5">webSockets</span><span class="hl-1"> } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&#39;@libp2p/websockets&#39;</span><br/><span class="hl-4">import</span><span class="hl-1"> { </span><span class="hl-5">WebRTC</span><span class="hl-1"> } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&#39;@multiformats/multiaddr-matcher&#39;</span><br/><span class="hl-4">import</span><span class="hl-1"> </span><span class="hl-5">delay</span><span class="hl-1"> </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&#39;delay&#39;</span><br/><span class="hl-4">import</span><span class="hl-1"> { </span><span class="hl-5">pipe</span><span class="hl-1"> } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&#39;it-pipe&#39;</span><br/><span class="hl-4">import</span><span class="hl-1"> { </span><span class="hl-5">createLibp2p</span><span class="hl-1"> } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&#39;libp2p&#39;</span><br/><span class="hl-4">import</span><span class="hl-1"> </span><span class="hl-4">type</span><span class="hl-1"> { </span><span class="hl-5">Multiaddr</span><span class="hl-1"> } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&#39;@multiformats/multiaddr&#39;</span><br/><br/><span class="hl-3">// the relay server listens on a transport dialable by the listener and the</span><br/><span class="hl-3">// dialer, and has a relay service configured</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">relay</span><span class="hl-1"> = </span><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-0">createLibp2p</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-5">addresses:</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-5">listen:</span><span class="hl-1"> [</span><span class="hl-2">&#39;/ip4/127.0.0.1/tcp/0/ws&#39;</span><span class="hl-1">]</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-5">transports:</span><span class="hl-1"> [</span><br/><span class="hl-1">    </span><span class="hl-0">webSockets</span><span class="hl-1">()</span><br/><span class="hl-1">  ],</span><br/><span class="hl-1">  </span><span class="hl-5">connectionEncrypters:</span><span class="hl-1"> [</span><span class="hl-0">noise</span><span class="hl-1">()],</span><br/><span class="hl-1">  </span><span class="hl-5">streamMuxers:</span><span class="hl-1"> [</span><span class="hl-0">yamux</span><span class="hl-1">()],</span><br/><span class="hl-1">  </span><span class="hl-5">connectionGater:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-0">denyDialMultiaddr</span><span class="hl-5">:</span><span class="hl-1"> () </span><span class="hl-6">=&gt;</span><span class="hl-1"> </span><span class="hl-6">false</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-5">services:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-5">identify:</span><span class="hl-1"> </span><span class="hl-0">identify</span><span class="hl-1">(),</span><br/><span class="hl-1">    </span><span class="hl-5">relay:</span><span class="hl-1"> </span><span class="hl-0">circuitRelayServer</span><span class="hl-1">()</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">})</span><br/><br/><span class="hl-3">// the listener has a WebSocket transport to dial the relay, a Circuit Relay</span><br/><span class="hl-3">// transport to make a reservation, and a WebRTC transport to accept incoming</span><br/><span class="hl-3">// WebRTC connections</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">listener</span><span class="hl-1"> = </span><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-0">createLibp2p</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-5">addresses:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-5">listen:</span><span class="hl-1"> [</span><br/><span class="hl-1">      </span><span class="hl-2">&#39;/p2p-circuit&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-2">&#39;/webrtc&#39;</span><br/><span class="hl-1">    ]</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-5">transports:</span><span class="hl-1"> [</span><br/><span class="hl-1">    </span><span class="hl-0">webSockets</span><span class="hl-1">(),</span><br/><span class="hl-1">    </span><span class="hl-0">webRTC</span><span class="hl-1">(),</span><br/><span class="hl-1">    </span><span class="hl-0">circuitRelayTransport</span><span class="hl-1">()</span><br/><span class="hl-1">  ],</span><br/><span class="hl-1">  </span><span class="hl-5">connectionEncrypters:</span><span class="hl-1"> [</span><span class="hl-0">noise</span><span class="hl-1">()],</span><br/><span class="hl-1">  </span><span class="hl-5">streamMuxers:</span><span class="hl-1"> [</span><span class="hl-0">yamux</span><span class="hl-1">()],</span><br/><span class="hl-1">  </span><span class="hl-5">connectionGater:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-0">denyDialMultiaddr</span><span class="hl-5">:</span><span class="hl-1"> () </span><span class="hl-6">=&gt;</span><span class="hl-1"> </span><span class="hl-6">false</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-5">services:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-5">identify:</span><span class="hl-1"> </span><span class="hl-0">identify</span><span class="hl-1">(),</span><br/><span class="hl-1">    </span><span class="hl-5">echo:</span><span class="hl-1"> </span><span class="hl-0">echo</span><span class="hl-1">()</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">})</span><br/><br/><span class="hl-3">// the listener dials the relay (or discovers a public relay via some other</span><br/><span class="hl-3">// method)</span><br/><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-5">listener</span><span class="hl-1">.</span><span class="hl-0">dial</span><span class="hl-1">(</span><span class="hl-5">relay</span><span class="hl-1">.</span><span class="hl-0">getMultiaddrs</span><span class="hl-1">(), {</span><br/><span class="hl-1">  </span><span class="hl-5">signal:</span><span class="hl-1"> </span><span class="hl-5">AbortSignal</span><span class="hl-1">.</span><span class="hl-0">timeout</span><span class="hl-1">(</span><span class="hl-8">5000</span><span class="hl-1">)</span><br/><span class="hl-1">})</span><br/><br/><span class="hl-6">let</span><span class="hl-1"> </span><span class="hl-5">webRTCMultiaddr</span><span class="hl-1">: </span><span class="hl-9">Multiaddr</span><span class="hl-1"> | </span><span class="hl-9">undefined</span><br/><br/><span class="hl-3">// wait for the listener to make a reservation on the relay</span><br/><span class="hl-4">while</span><span class="hl-1"> (</span><span class="hl-6">true</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-5">webRTCMultiaddr</span><span class="hl-1"> = </span><span class="hl-5">listener</span><span class="hl-1">.</span><span class="hl-0">getMultiaddrs</span><span class="hl-1">().</span><span class="hl-0">find</span><span class="hl-1">(</span><span class="hl-5">ma</span><span class="hl-1"> </span><span class="hl-6">=&gt;</span><span class="hl-1"> </span><span class="hl-5">WebRTC</span><span class="hl-1">.</span><span class="hl-0">matches</span><span class="hl-1">(</span><span class="hl-5">ma</span><span class="hl-1">))</span><br/><br/><span class="hl-1">  </span><span class="hl-4">if</span><span class="hl-1"> (</span><span class="hl-5">webRTCMultiaddr</span><span class="hl-1"> != </span><span class="hl-6">null</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-4">break</span><br/><span class="hl-1">  }</span><br/><br/><span class="hl-1">  </span><span class="hl-3">// try again later</span><br/><span class="hl-1">  </span><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-0">delay</span><span class="hl-1">(</span><span class="hl-8">1000</span><span class="hl-1">)</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-3">// the dialer has Circuit Relay, WebSocket and WebRTC transports to dial</span><br/><span class="hl-3">// the listener via the relay, complete the SDP handshake and establish a</span><br/><span class="hl-3">// direct WebRTC connection</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">dialer</span><span class="hl-1"> = </span><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-0">createLibp2p</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-5">transports:</span><span class="hl-1"> [</span><br/><span class="hl-1">    </span><span class="hl-0">webSockets</span><span class="hl-1">(),</span><br/><span class="hl-1">    </span><span class="hl-0">webRTC</span><span class="hl-1">(),</span><br/><span class="hl-1">    </span><span class="hl-0">circuitRelayTransport</span><span class="hl-1">()</span><br/><span class="hl-1">  ],</span><br/><span class="hl-1">  </span><span class="hl-5">connectionEncrypters:</span><span class="hl-1"> [</span><span class="hl-0">noise</span><span class="hl-1">()],</span><br/><span class="hl-1">  </span><span class="hl-5">streamMuxers:</span><span class="hl-1"> [</span><span class="hl-0">yamux</span><span class="hl-1">()],</span><br/><span class="hl-1">  </span><span class="hl-5">connectionGater:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-0">denyDialMultiaddr</span><span class="hl-5">:</span><span class="hl-1"> () </span><span class="hl-6">=&gt;</span><span class="hl-1"> </span><span class="hl-6">false</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-5">services:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-5">identify:</span><span class="hl-1"> </span><span class="hl-0">identify</span><span class="hl-1">(),</span><br/><span class="hl-1">    </span><span class="hl-5">echo:</span><span class="hl-1"> </span><span class="hl-0">echo</span><span class="hl-1">()</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">})</span><br/><br/><span class="hl-3">// dial the listener and open an echo protocol stream</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">stream</span><span class="hl-1"> = </span><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-5">dialer</span><span class="hl-1">.</span><span class="hl-0">dialProtocol</span><span class="hl-1">(</span><span class="hl-5">webRTCMultiaddr</span><span class="hl-1">, </span><span class="hl-5">dialer</span><span class="hl-1">.</span><span class="hl-5">services</span><span class="hl-1">.</span><span class="hl-5">echo</span><span class="hl-1">.</span><span class="hl-5">protocol</span><span class="hl-1">, {</span><br/><span class="hl-1">  </span><span class="hl-5">signal:</span><span class="hl-1"> </span><span class="hl-5">AbortSignal</span><span class="hl-1">.</span><span class="hl-0">timeout</span><span class="hl-1">(</span><span class="hl-8">5000</span><span class="hl-1">)</span><br/><span class="hl-1">})</span><br/><br/><span class="hl-3">// we can now stop the relay</span><br/><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-5">relay</span><span class="hl-1">.</span><span class="hl-0">stop</span><span class="hl-1">()</span><br/><br/><span class="hl-3">// send/receive some data from the remote peer via a direct connection</span><br/><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-0">pipe</span><span class="hl-1">(</span><br/><span class="hl-1">  [</span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-0">TextEncoder</span><span class="hl-1">().</span><span class="hl-0">encode</span><span class="hl-1">(</span><span class="hl-2">&#39;hello world&#39;</span><span class="hl-1">)],</span><br/><span class="hl-1">  </span><span class="hl-5">stream</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-6">async</span><span class="hl-1"> </span><span class="hl-5">source</span><span class="hl-1"> </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">for</span><span class="hl-1"> </span><span class="hl-4">await</span><span class="hl-1"> (</span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">buf</span><span class="hl-1"> </span><span class="hl-6">of</span><span class="hl-1"> </span><span class="hl-5">source</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-5">console</span><span class="hl-1">.</span><span class="hl-0">info</span><span class="hl-1">(</span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-0">TextDecoder</span><span class="hl-1">().</span><span class="hl-0">decode</span><span class="hl-1">(</span><span class="hl-5">buf</span><span class="hl-1">.</span><span class="hl-0">subarray</span><span class="hl-1">()))</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">)</span>
</code><button type="button">Copy</button></pre>

</div><div class="tsd-tag-example"><h4 class="tsd-anchor-link" id="example-webrtc-direct">Example: WebRTC Direct<a href="#example-webrtc-direct" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><p>WebRTC Direct allows a client to establish a WebRTC connection to a server
without using a relay to first exchange SDP messages.</p>
<p>Instead the server listens on a public UDP port and embeds its certificate
hash in the published multiaddr. It derives the client's SDP offer based on
the incoming IP/port of STUN messages sent to this public port.</p>
<p>The client derives the server's SDP answer based on the information in the
multiaddr so no SDP handshake via a third party is required.</p>
<p>Full details of the connection protocol can be found in the <a href="https://github.com/libp2p/specs/blob/master/webrtc/webrtc-direct.md">WebRTC Direct spec</a>.</p>
<p>Browsers cannot listen on WebRTC Direct addresses since they cannot open
ports, but they can dial all spec-compliant servers.</p>
<p>Node.js/go and rust-libp2p can listen on and dial WebRTC Direct addresses.</p>
<pre><code class="TypeScript"><span class="hl-4">import</span><span class="hl-1"> { </span><span class="hl-5">createLibp2p</span><span class="hl-1"> } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&#39;libp2p&#39;</span><br/><span class="hl-4">import</span><span class="hl-1"> { </span><span class="hl-5">multiaddr</span><span class="hl-1"> } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&#39;@multiformats/multiaddr&#39;</span><br/><span class="hl-4">import</span><span class="hl-1"> { </span><span class="hl-5">pipe</span><span class="hl-1"> } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&#39;it-pipe&#39;</span><br/><span class="hl-4">import</span><span class="hl-1"> { </span><span class="hl-5">fromString</span><span class="hl-1">, </span><span class="hl-5">toString</span><span class="hl-1"> } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&#39;uint8arrays&#39;</span><br/><span class="hl-4">import</span><span class="hl-1"> { </span><span class="hl-5">webRTCDirect</span><span class="hl-1"> } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&#39;@libp2p/webrtc&#39;</span><br/><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">listener</span><span class="hl-1"> = </span><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-0">createLibp2p</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-5">addresses:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-5">listen:</span><span class="hl-1"> [</span><br/><span class="hl-1">      </span><span class="hl-2">&#39;/ip4/0.0.0.0/udp/0/webrtc-direct&#39;</span><br/><span class="hl-1">    ]</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-5">transports:</span><span class="hl-1"> [</span><br/><span class="hl-1">    </span><span class="hl-0">webRTCDirect</span><span class="hl-1">()</span><br/><span class="hl-1">  ]</span><br/><span class="hl-1">})</span><br/><br/><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-5">listener</span><span class="hl-1">.</span><span class="hl-0">start</span><span class="hl-1">()</span><br/><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">dialer</span><span class="hl-1"> = </span><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-0">createLibp2p</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-5">transports:</span><span class="hl-1"> [</span><br/><span class="hl-1">    </span><span class="hl-0">webRTCDirect</span><span class="hl-1">()</span><br/><span class="hl-1">  ]</span><br/><span class="hl-1">})</span><br/><br/><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-5">dialer</span><span class="hl-1">.</span><span class="hl-0">start</span><span class="hl-1">()</span><br/><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">stream</span><span class="hl-1"> = </span><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-5">dialer</span><span class="hl-1">.</span><span class="hl-0">dialProtocol</span><span class="hl-1">(</span><span class="hl-5">listener</span><span class="hl-1">.</span><span class="hl-0">getMultiaddrs</span><span class="hl-1">(), </span><span class="hl-2">&#39;/my-protocol/1.0.0&#39;</span><span class="hl-1">, {</span><br/><span class="hl-1">  </span><span class="hl-5">signal:</span><span class="hl-1"> </span><span class="hl-5">AbortSignal</span><span class="hl-1">.</span><span class="hl-0">timeout</span><span class="hl-1">(</span><span class="hl-8">10_000</span><span class="hl-1">)</span><br/><span class="hl-1">})</span><br/><br/><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-0">pipe</span><span class="hl-1">(</span><br/><span class="hl-1">  [</span><span class="hl-0">fromString</span><span class="hl-1">(</span><span class="hl-2">`Hello js-libp2p-webrtc</span><span class="hl-13">\n</span><span class="hl-2">`</span><span class="hl-1">)],</span><br/><span class="hl-1">  </span><span class="hl-5">stream</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-6">async</span><span class="hl-1"> </span><span class="hl-6">function</span><span class="hl-1"> (</span><span class="hl-5">source</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-4">for</span><span class="hl-1"> </span><span class="hl-4">await</span><span class="hl-1"> (</span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">buf</span><span class="hl-1"> </span><span class="hl-6">of</span><span class="hl-1"> </span><span class="hl-5">source</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-5">console</span><span class="hl-1">.</span><span class="hl-0">info</span><span class="hl-1">(</span><span class="hl-0">toString</span><span class="hl-1">(</span><span class="hl-5">buf</span><span class="hl-1">.</span><span class="hl-0">subarray</span><span class="hl-1">()))</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">)</span>
</code><button type="button">Copy</button></pre>

<h2 id="webrtc-direct-certificate-hashes" class="tsd-anchor-link">WebRTC Direct certificate hashes<a href="#webrtc-direct-certificate-hashes" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>WebRTC Direct listeners publish the hash of their TLS certificate as part of
the listening multiaddr.</p>
<p>By default these certificates are generated at start up using an ephemeral
keypair that only exists while the node is running.</p>
<p>This means that the certificate hashes change when the node is restarted,
which can be undesirable if multiaddrs are intended to be long lived (e.g.
if the node is used as a network bootstrapper).</p>
<p>To reuse the same certificate and keypair, configure a persistent datastore
and the <a href="https://www.npmjs.com/package/@libp2p/keychain">@libp2p/keychain</a>
service as part of your service map:</p>
</div><div class="tsd-tag-example"><h4 class="tsd-anchor-link" id="example-reuse-tls-certificates-after-restart">Example: Reuse TLS certificates after restart<a href="#example-reuse-tls-certificates-after-restart" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><pre><code class="ts"><span class="hl-4">import</span><span class="hl-1"> { </span><span class="hl-5">LevelDatastore</span><span class="hl-1"> } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&#39;datastore-level&#39;</span><br/><span class="hl-4">import</span><span class="hl-1"> { </span><span class="hl-5">webRTCDirect</span><span class="hl-1"> } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&#39;@libp2p/webrtc&#39;</span><br/><span class="hl-4">import</span><span class="hl-1"> { </span><span class="hl-5">keychain</span><span class="hl-1"> } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&#39;@libp2p/keychain&#39;</span><br/><span class="hl-4">import</span><span class="hl-1"> { </span><span class="hl-5">createLibp2p</span><span class="hl-1"> } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&#39;libp2p&#39;</span><br/><br/><span class="hl-3">// store data on disk between restarts</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">datastore</span><span class="hl-1"> = </span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-0">LevelDatastore</span><span class="hl-1">(</span><span class="hl-2">&#39;/path/to/store&#39;</span><span class="hl-1">)</span><br/><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">listener</span><span class="hl-1"> = </span><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-0">createLibp2p</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-5">addresses:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-5">listen:</span><span class="hl-1"> [</span><br/><span class="hl-1">      </span><span class="hl-2">&#39;/ip4/0.0.0.0/udp/0/webrtc-direct&#39;</span><br/><span class="hl-1">    ]</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-5">datastore</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-5">transports:</span><span class="hl-1"> [</span><br/><span class="hl-1">    </span><span class="hl-0">webRTCDirect</span><span class="hl-1">()</span><br/><span class="hl-1">  ],</span><br/><span class="hl-1">  </span><span class="hl-5">services:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-5">keychain:</span><span class="hl-1"> </span><span class="hl-0">keychain</span><span class="hl-1">()</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">})</span><br/><br/><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-5">listener</span><span class="hl-1">.</span><span class="hl-0">start</span><span class="hl-1">()</span><br/><br/><span class="hl-5">console</span><span class="hl-1">.</span><span class="hl-0">info</span><span class="hl-1">(</span><span class="hl-5">listener</span><span class="hl-1">.</span><span class="hl-0">getMultiaddrs</span><span class="hl-1">())</span><br/><span class="hl-3">// /ip4/...../udp/../webrtc-direct/certhash/foo</span><br/><br/><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-5">listener</span><span class="hl-1">.</span><span class="hl-0">stop</span><span class="hl-1">()</span><br/><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-5">listener</span><span class="hl-1">.</span><span class="hl-0">start</span><span class="hl-1">()</span><br/><br/><span class="hl-5">console</span><span class="hl-1">.</span><span class="hl-0">info</span><span class="hl-1">(</span><span class="hl-5">listener</span><span class="hl-1">.</span><span class="hl-0">getMultiaddrs</span><span class="hl-1">())</span><br/><span class="hl-3">// /ip4/...../udp/../webrtc-direct/certhash/foo</span>
</code><button type="button">Copy</button></pre>

</div></div></section><details class="tsd-panel-group tsd-member-group tsd-accordion" open><summary class="tsd-accordion-summary" data-key="section-Interfaces"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg><h2>Interfaces</h2></summary><dl class="tsd-member-summaries"><dt class="tsd-member-summary" id="datachanneloptions"><span class="tsd-member-summary-name"><svg class="tsd-kind-icon" viewBox="0 0 24 24" aria-label="Interface"><use href="../assets/icons.svg#icon-256"></use></svg><a href="../interfaces/_libp2p_webrtc.DataChannelOptions.html">DataChannelOptions</a><a href="#datachanneloptions" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></span></dt><dd class="tsd-member-summary"></dd><dt class="tsd-member-summary" id="transportcertificate"><span class="tsd-member-summary-name"><svg class="tsd-kind-icon" viewBox="0 0 24 24" aria-label="Interface"><use href="../assets/icons.svg#icon-256"></use></svg><a href="../interfaces/_libp2p_webrtc.TransportCertificate.html">TransportCertificate</a><a href="#transportcertificate" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></span></dt><dd class="tsd-member-summary"></dd><dt class="tsd-member-summary" id="webrtcdirecttransportcomponents"><span class="tsd-member-summary-name"><svg class="tsd-kind-icon" viewBox="0 0 24 24" aria-label="Interface"><use href="../assets/icons.svg#icon-256"></use></svg><a href="../interfaces/_libp2p_webrtc.WebRTCDirectTransportComponents.html">WebRTCDirectTransportComponents</a><a href="#webrtcdirecttransportcomponents" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></span></dt><dd class="tsd-member-summary"></dd><dt class="tsd-member-summary" id="webrtctransportcomponents"><span class="tsd-member-summary-name"><svg class="tsd-kind-icon" viewBox="0 0 24 24" aria-label="Interface"><use href="../assets/icons.svg#icon-256"></use></svg><a href="../interfaces/_libp2p_webrtc.WebRTCTransportComponents.html">WebRTCTransportComponents</a><a href="#webrtctransportcomponents" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></span></dt><dd class="tsd-member-summary"></dd><dt class="tsd-member-summary" id="webrtctransportdirectinit"><span class="tsd-member-summary-name"><svg class="tsd-kind-icon" viewBox="0 0 24 24" aria-label="Interface"><use href="../assets/icons.svg#icon-256"></use></svg><a href="../interfaces/_libp2p_webrtc.WebRTCTransportDirectInit.html">WebRTCTransportDirectInit</a><a href="#webrtctransportdirectinit" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></span></dt><dd class="tsd-member-summary"></dd><dt class="tsd-member-summary" id="webrtctransportinit"><span class="tsd-member-summary-name"><svg class="tsd-kind-icon" viewBox="0 0 24 24" aria-label="Interface"><use href="../assets/icons.svg#icon-256"></use></svg><a href="../interfaces/_libp2p_webrtc.WebRTCTransportInit.html">WebRTCTransportInit</a><a href="#webrtctransportinit" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></span></dt><dd class="tsd-member-summary"></dd></dl></details><details class="tsd-panel-group tsd-member-group tsd-accordion" open><summary class="tsd-accordion-summary" data-key="section-Functions"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg><h2>Functions</h2></summary><dl class="tsd-member-summaries"><dt class="tsd-member-summary" id="webrtc"><span class="tsd-member-summary-name"><svg class="tsd-kind-icon" viewBox="0 0 24 24" aria-label="Function"><use href="../assets/icons.svg#icon-64"></use></svg><a href="../functions/_libp2p_webrtc.webRTC.html">webRTC</a><a href="#webrtc" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></span></dt><dd class="tsd-member-summary"></dd><dt class="tsd-member-summary" id="webrtcdirect"><span class="tsd-member-summary-name"><svg class="tsd-kind-icon" viewBox="0 0 24 24" aria-label="Function"><use href="../assets/icons.svg#icon-64"></use></svg><a href="../functions/_libp2p_webrtc.webRTCDirect.html">webRTCDirect</a><a href="#webrtcdirect" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></span></dt><dd class="tsd-member-summary"></dd></dl></details></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-accordion"><summary class="tsd-accordion-summary"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg><h3>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-filter-visibility"><span class="settings-label">Member Visibility</span><ul id="tsd-filter-options"><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></div><div class="tsd-theme-toggle"><label class="settings-label" for="tsd-theme">Theme</label><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg><h3>On This Page</h3></summary><div class="tsd-accordion-details"><a href="#webrtc-vs-webrtc-direct"><span>Web<wbr/>RTC vs <wbr/>Web<wbr/>RTC <wbr/>Direct</span></a><a href="#webrtc-direct-certificate-hashes"><span>Web<wbr/>RTC <wbr/>Direct certificate hashes</span></a><details open class="tsd-accordion tsd-page-navigation-section"><summary class="tsd-accordion-summary" data-key="section-Interfaces"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>Interfaces</summary><div><a href="#datachanneloptions"><svg class="tsd-kind-icon" viewBox="0 0 24 24" aria-label="Interface"><use href="../assets/icons.svg#icon-256"></use></svg><span>Data<wbr/>Channel<wbr/>Options</span></a><a href="#transportcertificate"><svg class="tsd-kind-icon" viewBox="0 0 24 24" aria-label="Interface"><use href="../assets/icons.svg#icon-256"></use></svg><span>Transport<wbr/>Certificate</span></a><a href="#webrtcdirecttransportcomponents"><svg class="tsd-kind-icon" viewBox="0 0 24 24" aria-label="Interface"><use href="../assets/icons.svg#icon-256"></use></svg><span>Web<wbr/>RTC<wbr/>Direct<wbr/>Transport<wbr/>Components</span></a><a href="#webrtctransportcomponents"><svg class="tsd-kind-icon" viewBox="0 0 24 24" aria-label="Interface"><use href="../assets/icons.svg#icon-256"></use></svg><span>Web<wbr/>RTC<wbr/>Transport<wbr/>Components</span></a><a href="#webrtctransportdirectinit"><svg class="tsd-kind-icon" viewBox="0 0 24 24" aria-label="Interface"><use href="../assets/icons.svg#icon-256"></use></svg><span>Web<wbr/>RTC<wbr/>Transport<wbr/>Direct<wbr/>Init</span></a><a href="#webrtctransportinit"><svg class="tsd-kind-icon" viewBox="0 0 24 24" aria-label="Interface"><use href="../assets/icons.svg#icon-256"></use></svg><span>Web<wbr/>RTC<wbr/>Transport<wbr/>Init</span></a></div></details><details open class="tsd-accordion tsd-page-navigation-section"><summary class="tsd-accordion-summary" data-key="section-Functions"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>Functions</summary><div><a href="#webrtc"><svg class="tsd-kind-icon" viewBox="0 0 24 24" aria-label="Function"><use href="../assets/icons.svg#icon-64"></use></svg><span>web<wbr/>RTC</span></a><a href="#webrtcdirect"><svg class="tsd-kind-icon" viewBox="0 0 24 24" aria-label="Function"><use href="../assets/icons.svg#icon-64"></use></svg><span>web<wbr/>RTC<wbr/>Direct</span></a></div></details></div></details></div><div class="site-menu"><nav class="tsd-navigation"><a href="../modules.html">libp2p</a><ul class="tsd-small-nested-navigation" id="tsd-nav-container"><li>Loading...</li></ul></nav></div></div></div><footer><p class="tsd-generator">Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></footer><div class="overlay"></div></body></html>
