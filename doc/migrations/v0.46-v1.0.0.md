<!--Specify versions for migration below-->
# Migrating to libp2p@1.0.0 <!-- omit in toc -->

A migration guide for refactoring your application code from libp2p `v0.46` to `v1.0.0`.

## Table of Contents <!-- omit in toc -->

- [AutoNAT](#autonat)
- [KeyChain](#keychain)
- [Metrics](#metrics)

## AutoNAT

The AutoNAT service is now published in its own package.

**Before**

```ts
import { autoNATService } from 'libp2p/autonat'
```

**After**

```ts
import { autoNATService } from '@libp2p/autonat'
```

## KeyChain

The KeyChain object is no longer included on Libp2p and must be instantiated explicitly if desired.

**Before**

```ts
import type { KeyChain } from '@libp2p/interface/keychain'

const libp2p = await createLibp2p(...)

const keychain: KeyChain = libp2p.keychain
```

**After**

```ts
import { DefaultKeyChain } from '@libp2p/keychain'
import type { KeyChain } from '@libp2p/interface/keychain'

const libp2p = await createLibp2p({
  ...
  services: {
    keychain: (components) => new DefaultKeyChain(components, {
      ...DefaultKeyChain.generateOptions()
    })
  }
})

const keychain: KeyChain = libp2p.services.keychain
```

## Metrics

The following metrics were renamed:

`libp2p_dialler_pending_dials` => `libp2p_dial_queue_pending_dials`
`libp2p_dialler_in_progress_dials` => `libp2p_dial_queue_in_progress_dials`
