# Workaround: https://github.com/docker/cli/issues/996
ARG BASE_IMAGE=node-js-libp2p-head
FROM ${BASE_IMAGE}

WORKDIR /app/interop

# Options: chromium, firefox, webkit
ARG BROWSER=chromium
ENV BROWSER=${BROWSER}

# hack to ensure the correct browser version is installed while building the
# container and not during the test run which slows everything down
RUN npx playwright-test --runner mocha --browser $BROWSER --grep do-not-match-anything

ENTRYPOINT npm test -- -t browser -- --browser $BROWSER
